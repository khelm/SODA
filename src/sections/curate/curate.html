<template class="task-template">
  <section id="curate-section" class="section js-section u-category-windows">

    <header class="section-header">
      <div class="section-wrapper">
        <h1>
          <img class="section-icon" src="assets/img/dataset-teal.png">
          Prepare Dataset
        </h1>
        <h3>This interface will walk you through the steps for performing an initial curation of your dataset before review by the Curation Team.
          <ul style="list-style-type:circle;">
            <li>Specify successively your requirements</li>
            <li>Validate your dataset</li>
            <li>Generate your SPARC dataset</li>
          </ul>
          Please watch <a href="https://youtu.be/T_AHgEUXFAA">this introduction video</a> before you get started. </h3>
      </div>
    </header>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-specfy-dataset-demo-toggle" class="js-container-target demo-toggle-button"> Specify dataset files
          <div class="demo-meta u-avoid-clicks"> Specify desired local files to be added in each of the SPARC folders of your dataset
          </div>
        </button>
        <div id="div-specify-dataset-files" class="demo-box">

          <form id = 'form-dataset-organize-form'>
            <div>
              <input id="organize-dataset" name="organizing-dataset" type="radio" class="with-style" />
              <label for="organize-dataset" class="labelradio"> Organize my dataset </label>
                <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                  <span class="tooltiptext">Select this option to conveniently organize your dataset following the SPARC folder structure
                  </span>
                </div>
            </div>
            <div style = "padding:10px 0px">
              <input id="preorganized-dataset" name="organizing-dataset" type="radio" class="with-style" />
              <label for="preorganized-dataset" class="labelradio"> Dataset already organized </label>
                <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                  <span class="tooltiptext">Select this option when you already have the SPARC folder structure in place and you only want, e.g., to add description, include metadata files, and/or validate your dataset
                  </span>
                </div>
            </div>
            <div>
              <input id="smart-organize-dataset" name="organizing-dataset" type="radio" class="with-style" />
              <label for="smart-organize-dataset" class="labelradio"> Smart organize </label>
                <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                  <span class="tooltiptext">Select to automatically organize your dataset based on a previously saved organized structure. This applies if you are following a strict dataset organization structure (different than SPARC) and only the high-level folder changes from dataset to dataset
                  </span>
                </div>
            </div>
          </form>


          <div id="div-smart-organize-dataset" class="datasetsaveoption">
            <div class="demo-controls">
              <p> Coming soon... Tentative date: December 2019 </p>
            </div>
          </div>

          <div id="div-pre-organized-dataset" class="datasetsaveoption">
            <h5> </h5>
            <div class="demo-controls">
                  <table id="table-organized" class = "pathtable">
                    <tr class="parent" id='code_org'>
                      <th class="table-header">code</th>
                      <th>description</th>
                    </tr>

                    <tr class="parent" id='derivatives_org'>
                      <th class="table-header">derivatives</th>
                      <th>description</th>
                    </tr>

                    <tr class="parent" id='docs_org'>
                      <th class="table-header">docs</th>
                      <th>description</th>
                    </tr>

                    <tr class="parent" id='primary_org'>
                      <th class="table-header">primary</th>
                      <th>description</th>
                    </tr>

                    <tr class="parent" id="protocol_org">
                    <th class="table-header">protocol</th>
                    <th>description</th>
                    </tr>

                    <tr class="parent" id='source_org'>
                      <th class="table-header">source</th>
                      <th>description</th>
                    </tr>

                    <tr class="parent" id='main_org'>
                      <th class="table-header">main</th>
                      <th>description</th>
                    </tr>
                  </table>
              </div>
              <h5> </h5>
              <div class="demo-controls">
                <button id="button-select-dataset" class="demo-button"> Select Dataset Folder </button>
                <p id="para-selected-dataset" style="margin-top:-5px"></p>
              </div>
          </div>

          <div id="div-organize-dataset" class="datasetsaveoption">
            <h5>  </h5>
            <div class="demo-controls">
                <table id="code_table" class = "pathtable">
                  <tr class="parent" id="code" droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                    <th class="table-header">code</th>
                    <th>description</th>
                  </tr>

                  <tr class="parent" id='derivatives' droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                    <th class="table-header">derivatives</th>
                    <th>description</th>
                  </tr>

                  <tr class="parent" id='docs' droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                    <th class="table-header">docs</th>
                    <th>description</th>
                  </tr>

                  <tr class="parent" id='primary' droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                    <th class="table-header">primary</th>
                    <th>description</th>
                  </tr>

                  <tr class="parent" id="protocol" droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                    <th class="table-header">protocol</th>
                    <th>description</th>
                  </tr>

                  <tr class="parent" id='source' droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                    <th class="table-header">source</th>
                    <th>description</th>
                  </tr>

                  <tr class="parent" id='main' droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                    <th class="table-header">main</th>
                    <th>description</th>
                  </tr>
                </table>
            </div>
            <hr>
            <h5> Select folders and files to be added in each SPARC folder. <br>
            The paths will be added under the corresponding table header.
              <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext">
                  Files are organized in SODA by adding them in the table under the desired header (corresponding to a SPARC folder). This table will then be used by the program to create your dataset when you reach the "Generate dataset" step.
                  <br><br>
                  Select SPARC folder from the drop-down list then add files/folders in the table using the corresponding buttons. Alternatively, you could drag-and-drop files/folders on the table headers to import them.
                  <br><br>
                  You can then add a description for the file/folder that will be included in the manifest file.
                  <br><br>
                  If a folder is added, only the path of the selected folder will be displayed in the table but all sub-folders and files will be included when the dataset is generated.
                  <br><br>
                  The 'main' folder designates the dataset folder.
                </span>
              </div>
            </h5>
            <div class="demo-controls">
            	<p> Select SPARC folder: <p>
              <div>	<select id="SPARCfolderlist">
                <option> code </option>
                <option> derivatives </option>
                <option> docs </option>
                <option> primary </option>
                <option> protocol </option>
                <option> source </option>
                <option> main </option></select>
              </div>
            </div>
            <div class="demo-controls">
                <p> Browse and select files/folders: </p>
              	<button id="button-select-code" class="demo-button">Add files </button>
              	<button id="button-select-code-directory" class="demo-button">Add folders</button>
            </div>
            <hr>
            <h5> Preview file organization
              <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext"> Get a preview of the dataset that will be generated based on the table.
                <br><br>
                The preview is created in a folder named 'Preview' and located in a 'SODA' folder on the user's computer. The files in the preview are mock files (0 kb) with only name and extension corresponding to the actual files.
                </span>
              </div>
            </h5>
            <div class="demo-controls">
                <button id="button-preview-file-organization" class="demo-button"> Preview </button>
                <p id='para-preview-organization-status'> <p>
            </div><br>
            <!-- <div class="demo-controls">
                <button id="button-delete-preview-organization-status" class="demo-button"> Delete Preview Folder </button>
                <p id='para-delete-preview-organization-status'> <p>
            </div> -->
            <hr>
            <h5> Import previously saved file structure
              <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext">Import progress file you saved previously (see 'Save' button below the table) and continue organizing your dataset</span>
              </div>
            </h5>
            <div class="demo-controls">
              <button id="button-select-upload-file-organization" class="demo-button"> Import </button>
              <p id='para-upload-file-organization-status'> <p>
            </div>

          </div>

          <div id="div-save-table" class="datasetsaveoption">
            <h5> Save file organization to continue later
              <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext">Save the table you created in a CSV format file for continuing later.
                 <br><br>
                 You can optionally add file/folder paths and descriptions directly in that CSV file (e.g. using MS Excel) before importing.
                 <br><br>
                 The 'Import' button is located above the table in 'Organize my dataset'. If you are saving your progress under the 'Dataset already organized' feature, you can import and continue there later.
                </span>
              </div>
            </h5>
            <div class="demo-controls">
              <button id="button-select-save-file-organization" class="demo-button"> Save </button>
              <p id='para-save-file-organization-status'> <p>
            </div>
          </div>

          <div id="div-smart-organize" class="datasetsaveoption">
            <hr>
            <h5> Smart Organize </h5>
            <button id="button-smart-organize-import-template" class="demo-button"> Import previous template </button>
                <table id="table-smart-organize-import" class="smarttable">
                  <tr class="parent" id='code_org'>
                    <th class="smart-table-header"> </th>
                  </tr>
                </table>
                <p id='para-smart-organize-import-template'> </p>
            <button id="button-smart-organize-folder-path" class="demo-button"> Select new dataset folder </button>
              <p id='para-smart-organize-folder-path'> </p>
            <button id="button-smart-organize-go" class="demo-button"> Go ! </button>
              <p id='para-smart-organize-go'> </p>
            <h5> List of unsure files </h5>
            <textarea id='unsure-paths' class='listprint' rows="10" readonly></textarea>
          </div>

          <div id="div-clear-table" class="datasetsaveoption">
            <hr>
            <h5> </h5>
            <button id="button-clear-table" class="demo-button"> Clear table </button>
          </div>

          <div id="div-organize-next-step" align="right">
            <h5> </h5>
            <button id="button-organize-next-step" class="demo-button"> Next step </button>
          </div>

        </div>
      </div>
    </div>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-file-conversion-demo-toggle" class="js-container-target demo-toggle-button"> Handle file format conversion
          <div class="demo-meta u-avoid-clicks"> Choose files to be converted to SPARC defined standard formats before generating your dataset  </div>
        </button>
        <div id="div-file-conversion" class="demo-box">
          <p> Coming soon... Tentative date: May 2020 </p>
          <div id="div-file-conversion-next-step" align="right">
            <h5> </h5>
            <button id="button-file-conversion-next-step" class="demo-button"> Next step </button>
          </div>
        </div>
      </div>
    </div>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-specify-metadata-demo-toggle" class="js-container-target demo-toggle-button">
        Specify metadata files to be attached
          <div class="demo-meta u-avoid-clicks"> Choose metadata files to be included in your dataset </div>
        </button>
        <div id="div-specify-metadata" class="demo-box">

          <h5>Manifest file
            <div class="tooltipnew"><img class="info" src="assets/img/info.png">
              <span class="tooltiptext">
              Select this option to include a manifest file in each of the SPARC folder. The 'filename', 'timestamp', and 'file type' fields will be populated automatically while 'description' will be populated with descriptions (if any) added in the table under 'Specify dataset files' section.
              </span>
            </div>
          </h5>

          <div class="demo-controls">
            <input id="generate-manifest" name="manifest" type="checkbox" class="with-style"/>
            <label for="generate-manifest" class="labelradio"> Include manifest files </label>
          </div>

          <h5>Submission file
            <div class="tooltipnew"><img class="info" src="assets/img/info.png">
              <span class="tooltiptext">
              For all other metadata files, the following options are available:
              <br><br>
              - Select existing: choose an already existing metadata file (e.g. created under the 'Prepare Metadata' section). The name must match with the file (e.g. 'submission.xlsx' or 'submission.csv' for submission file)
              <br><br>
              - Generate new from template: creates a new empty submission file based on the template provided by the Curation Team
              <br><br>
              - None: Do nothing (e.g. if you already have included the file under the 'main' header of the table)
              </span>
            </div>
          </h5>

          <form id='submission-file-form'>
            <div>
              <input id="existing-submission" name="submission_file_option" type="radio" class="with-style" value="existing" />
              <label for="existing-submission" class="labelradio">Select existing</label>
            </div>
            <div>
              <input id="new-submission" name="submission_file_option" type="radio" class="with-style" value="new" />
              <label for="new-submission" class="labelradio"> Include new from template</label>
            </div>
            <div>
              <input id="no-submission" name="submission_file_option" type="radio" class="with-style" value="none" checked/>
              <label for="no-submission" class="labelradio"> None </label>
            </div>
          </form>

          <div id="div-existing-submission" class="datasetsaveoption">
            <h5> </h5>
            <div class="demo-controls">
            <button id="button-select-submission" class="demo-button">Select submission file </button>
            <textarea id="selected-submission" class="demo-response"></textarea>
            </div>
          </div>

          <h5>Dataset description file</h5>

          <form id='description-file-form'>
            <div>
              <input id="existing-description" name="descripion_file_option" type="radio" class="with-style" />
              <label for="existing-description" class=labelradio>Select existing</label>
            </div>
            <div>
              <input id="new-description" name="descripion_file_option" type="radio" class="with-style" />
              <label for="new-description" class=labelradio> Include new from template</label>
            </div>
            <div>
              <input id="no-description" name="descripion_file_option" type="radio" class="with-style" checked/>
              <label for="no-description" class="labelradio"> None </label>
            </div>
          </form>

          <div id="div-existing-description" class="datasetsaveoption">
            <h5> </h5>
            <div class="demo-controls">
            <button id="button-select-description" class="demo-button">Select description file </button>
            <textarea id="selected-description" class="demo-response"></textarea>
            </div>
          </div>

          <h5>Subjects file</h5>

          <form id='subjects-file-form'>
            <div>
              <input id="existing-subjects" name="subjects_file_option" type="radio" class="with-style" />
              <label for="existing-subjects" class="labelradio">Select existing</label>
            </div>
            <div>
              <input id="new-subjects" name="subjects_file_option" type="radio" class="with-style" />
              <label for="new-subjects" class="labelradio"> Include new from template</label>
            </div>
            <div>
              <input id="no-subjects" name="subjects_file_option" type="radio" class="with-style" checked/>
              <label for="no-subjects" class="labelradio"> None </label>
            </div>
          </form>

          <div id="div-existing-subjects" class="datasetsaveoption">
            <h5> </h5>
            <div class="demo-controls">
            <button id="button-select-subjects" class="demo-button">Select subjects file </button>
            <textarea class="demo-response" id="selected-subjects"></textarea>
            </div>
          </div>

          <h5>Samples file</h5>

          <form id='samples-file-form'>
            <div>
              <input id="existing-samples" name="samples_file_option" type="radio" class="with-style" />
              <label for="existing-samples" class="labelradio">Select existing </label>
            </div>
            <div>
              <input id="new-samples" name="samples_file_option" type="radio" class="with-style" />
              <label for="new-samples" class="labelradio"> Include new from template </label>
            </div>
            <div>
              <input id="no-samples" name="samples_file_option" type="radio" class="with-style" checked/>
              <label for="no-samples" class="labelradio"> None </label>
            </div>
          </form>

          <div id="div-existing-samples" class="datasetsaveoption">
            <h5> </h5>
            <div class="demo-controls">
              <button id="button-select-samples" class="demo-button">Select samples file </button>
              <textarea class="demo-response" id="selected-samples"></textarea>
            </div>
          </div>

          <div id="div-specify-metadata-next-step" align="right">
            <h5> </h5>
            <button id="button-specify-metadata-next-step" class="demo-button"> Next step </button>
          </div>
        </div>
      </div>
    </div>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-validate-dataset-demo-toggle" class="js-container-target demo-toggle-button"> Validate dataset before generating
          <div class="demo-meta u-avoid-clicks"> Validate that information provided during the previous steps will create a SPARC-approved dataset using validator developed by the SPARC Curation Team </div>
        </button>
        <div id="div-validate-dataset" class="demo-box">
          <p> Coming soon... Tentative date: February 2020 </p>
          <div id="div-validate-dataset-next-step" align="right">
            <h5> </h5>
            <button id="button-validate-dataset-next-step" class="demo-button"> Next step </button>
          </div>
        </div>
      </div>
    </div>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-generate-dataset-demo-toggle" class="js-container-target demo-toggle-button"> Generate dataset
          <div class="demo-meta u-avoid-clicks"> Create dataset based on information specified during the previous steps (dataset could be created locally or pushed directly to Blackfynn) </div>
        </button>

        <div id="div-generate-dataset" class="demo-box">

          <h5> New dataset</h5>
          <form id = 'dataset-curate-form'>
            <div id = "div-existing-dataset">
              <input id="existing-dataset" name="newdataset" type="radio" class="with-style" />
              <label id = "label-existing-dataset" for="existing-dataset" class=labelradio> Modify current dataset</label>
                <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                  <span class="tooltiptext">This will add all changes to the current dataset folder.
                  <br>
                  This option will only be available when 'Dataset already organized' option is selected.
                  <br>
                  No file will be deleted even if you removed it from the table. Delete manually or choose 'Create new dataset locally'</span>
                </div>
            </div>
            <div style = "padding:10px 0px">
              <input id="create-newdataset" name="newdataset" type="radio" class="with-style" />
              <label for="create-newdataset" class=labelradio>Create new dataset locally</label>
                <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                  <span class="tooltiptext">This option will create the dataset at the desired location locally with all requested files</span>
                </div>
            </div>
            <div>
              <input id="cloud-dataset" name="newdataset" type="radio" class="with-style" />
              <label for="cloud-dataset" class="labelradio">Create new dataset directly on Blackfynn</label>
                <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                  <span class="tooltiptext">This option will create the dataset with all requested files directly on your Blackfynn account</span>
                </div>
            </div>
          </form>

          <div id="div-create-new" class="datasetsaveoption">

            <h5> Select destination folder for new dataset </h5>
            <div class="demo-controls">
              <button id="button-select-new-dataset" class="demo-button"> Select Destination </button>
              <textarea class="demo-response" id="selected-new-dataset"></textarea>
            </div>

            <h5> Enter a name for the new dataset  </h5>
              <div class="demo-controls">
                <textarea class="demo-response" id="new-dataset-name"></textarea>
              </div>
          </div>

          <div id="div-create-cloud" class="datasetsaveoption">
            <h5> </h5>
            <button id="button-upload-check-bf-account-details" class="demo-button"> Load existing account(s) </button>
            <h5> Select account </h5>
            <div class="demo-controls">
              <select id="bfuploadaccountlist" class="my_dropdown">
                <option> Select </option>
              </select>
            </div>
            <div id=div-bf-account-load-progress-curate class="progressdiv">
              <div class="indeterminatebar"></div>
            </div>
            <p id='para-upload-select-account-status'> <p>

            <p> </p>

            <!-- <h5> Select local dataset to submit
              <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext">Select the local folder that you want to submit to your Blackfynn account</span>
              </div>
            </h5>
            <div class="demo-controls">
              <button id="button-select-submit-dataset" class="demo-button">Select Dataset Folder </button>
              <textarea class="demo-response" id="selected-submit-dataset"></textarea>
            </div> -->

            <h5> Select Blackfynn Dataset for uploading
              <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext">Select the target dataset on your Blackfynn account (sorted alphabetically)</span>
              </div>
            </h5>
            <div class="demo-controls">
              <select class="my_dropdown" id="bfuploaddatasetlist">
                <option> Select dataset </option>
              </select>
            </div>

            <h5> </h5>
            <div class="demo-controls">
              <button id="button-upload-refresh-dataset-list" class="demo-button"> Refresh list </button>
            </div>
          </div>

          <div id="div-curate-button" class="datasetsaveoption">
            <h5> Apply changes </h5>
            <button id="button-curate-dataset" class="demo-button"> Generate </button>
          </div>

          <div id="div-curate-progress-bar-error-status" class="datasetsaveoption">
            <p id='para-curate-progress-bar-error-status'> <p>
          </div>

          <div id="div-curate-meter-progress" class="datasetsaveoption">
            <h5> Progress </h5>
            <progress class=progresstrack id=progress-bar-curate max="100" value="0"></progress>
          </div>

          <div id="div-curate-progress-bar-status" class="datasetsaveoption">
            <p id='para-curate-progress-bar-status'> <p>
          </div>


          <!-- <div id="div-progress-print" class="datasetsaveoption">
            <h5> Progress </h5>
            <textarea id='progressinfo' class='outputprint' rows="25" readonly></textarea>
          </div> -->
        </div>
      </div>
    </div>

    <script type="text/javascript">
      require('./renderer-process/curate/radio-buttons-display')
    </script>

    <script type="text/javascript" src="./renderer-process/curate/table-script.js">
    </script>

  </section>
</template>
